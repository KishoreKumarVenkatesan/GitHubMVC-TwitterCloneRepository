@using TwitterClone.UI.Models
@model TweetModel
@{
    ViewBag.MainTitle = "My Twitter Clone";

}
@{
    var name = ViewBag.UserFullName;
    List<TwitterClone.Entities.TweetModel> lstTweets = ViewBag.TweetComments;
    var tweetCount = ViewBag.TweetCount;
    List<TwitterClone.Entities.ManageProfile> lstPerson = ViewBag.PersonList;
    List<TwitterClone.Entities.FollowingUser> lstFollowingUser = ViewBag.FollowingUsers;
}
<h1>@ViewBag.MainTitle</h1>
<div style="background-color:aliceblue">
    <lable style="margin-left:750px; font-weight:bold;font-size:large;">Welcome: @ViewBag.UserFullName </lable>
    <div class="navbar-collapse collapse" style="float:right !important">

        <ul class="nav navbar-nav">

            <li style="font-size:large">@Html.ActionLink("Home", "Index", "TweetHome")  </li>
            <li style="font-size:large">@Html.ActionLink("Profile", "EditProfile", "Account")  </li>
            <li style="font-size:large">@Html.ActionLink("SignOut", "SignOut", "Account")</li>
        </ul>
    </div>
    @using (Html.BeginForm("SearchPerson", "TweetHome", FormMethod.Post, new { @id = "name" }))
    {
        @Html.AntiForgeryToken()

        <div class="form-inline">

            <input type="text" id="name" name="name" class="form-control" placeholder="Search Person">
            <input type="submit" class="btn btn-primary" value="Search" />


        </div>


    }
    <br />

    @using (Html.BeginForm("UpdateFollowers", "TweetHome", FormMethod.Post, new { @id = "followerName" }))
    {
        @Html.AntiForgeryToken()
        <div style="border:solid 1px;max-height:250px; min-height:100px; width:382px !important" class="panel-body">
            @if (lstPerson != null)
            {
                foreach (var person in lstPerson)
                {


                    <lable id="followerName" style="font-weight:bold;  min-width:45px;">@person.fullName</lable>
                    <lable style="font-weight:bold; min-width:45px;">@person.email</lable>
                    <input type="hidden" id="followerName" name="followerName" value="@person.fullName" />
                    <input type="hidden" id="email" name="email" value="@person.email" />
                    <input type="submit" class="btn btn-danger" value="Follow" />
                    <br />
                }
            }
        </div>
    }

    @using (Html.BeginForm("SetTweetMessage", "TweetHome", FormMethod.Post, new { @id = "tweetId", @class = "form-horizontal", role = "form" }))
            {
        @Html.AntiForgeryToken()

        <div class="form-group" style="margin-top:-144px !important">
            <lable style="margin-left:421px;  font-weight:bold; font-size:large ">What are you doing?</lable>
            @*<p>
                    <@Html.(model => model.message) %>
                </p>*@
            <div style="margin-left:421px;">
                @Html.TextAreaFor(model => model.message, 5, 5000, new { @id = "TweetMessage", style = "max-width:750px", htmlAttributes = new { @class = "form-control" } })
                <span id='remainingC'></span>
                @Html.ValidationMessageFor(model => model.message, "", new { @class = "text-danger" })
            </div>

        </div>



                <div class="form-group" style="margin-left:721px; float:right">

                    <div class="col-md-offset-2 col-md-10">
                        <input type="submit" class="btn btn-primary" value="Update" />
                    </div>
                </div>
    }
    <div class="navbar-collapse collapse">

        @*<ul class="nav navbar-nav">*@

        <ul style="font-size:large">@ViewBag.TweetCount Tweets</ul>
        <ul style="font-size:large"> @ViewBag.FollowingCount @Html.ActionLink("Following", "GetFollowingUsers", "TweetHome")  </ul>
        <ul style="font-size:large">@ViewBag.FollowerCount @Html.ActionLink("Followers", "GetFollowers", "TweetHome")</ul>
        @*</ul>*@
    </div>
    <div style="border:solid 1px;max-height:250px; width:382px !important" class="panel-body">
        @if (lstFollowingUser != null)
        {
            foreach (var followingUser in lstFollowingUser)
            {
                <lable id="followerName" style="font-weight:bold;  min-width:45px;">@followingUser.fullName</lable>
                <lable style="font-weight:bold; min-width:45px;">@followingUser.email</lable>
                <br />
            }
        }
    </div>
    <div class="form-group" style="margin-top:-110px !important">
        <lable style="margin-left:421px; font-weight:bold; font-size:large; ">Tweets</lable>

        <div style="margin-left:421px; border:solid 1px" class="panel-body">
            @foreach (var tweet in lstTweets)
            {
                <span class="text-muted" id="tweet-userid" style="font-weight:bold;  ">@tweet.user_Id</span>
                <span class="text-muted tweet-text" style="margin-left:50px; font-weight:bold; ">@tweet.message</span>
                        <span class="text-muted " style="margin-left:50px; font-weight:bold; ">@tweet.CreatedDate</span>
                        <br />
            }

        </div>
    </div>

</div>

    @section Scripts {
        @Scripts.Render("~/bundles/jqueryval")
<script type="text/javascript">
        $(function () {
            $('textarea').keypress(function (e) {
                debugger;
                if(this.value.length > 160)
                {
                    return false;
                }
                $("#remainingC").html("Remaining characters : " + (160 - this.value.length));
            });
        });

</script>
    }
